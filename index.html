<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>HÃ¼seyin AkdaÄŸ Ä°lkokulu Fen Bilimleri 4. Tema YarÄ±ÅŸmasÄ±</title>

  <style>
    :root{
      --bg0:#060314;
      --bg1:#0a0830;

      --panel: rgba(6,6,18,.72);

      /* Mor-Mavi Neon */
      --blue:#43b7ff;
      --purple:#b45cff;
      --pink:#ff4fd8;

      --text:#f4f8ff;
      --muted:#b7bce8;

      --good:#22c55e;
      --bad:#ef4444;

      --radius:22px;
      --shadow: 0 30px 90px rgba(0,0,0,.62);

      --glowBlue: 0 0 18px rgba(67,183,255,.22), 0 0 46px rgba(67,183,255,.12);
      --glowBlueStrong: 0 0 24px rgba(67,183,255,.32), 0 0 70px rgba(67,183,255,.18);
      --glowPurple: 0 0 18px rgba(180,92,255,.22), 0 0 46px rgba(180,92,255,.12);

      /* Arka plan gÃ¶rseli */
      --bgImg: none;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--text);

      /* GÃ¶rsel + gradient katmanlar */
      background-image:
        linear-gradient(180deg, rgba(6,3,20,.78), rgba(10,8,48,.74)),
        var(--bgImg);
      background-size: cover, cover;
      background-position: center, center;
      background-attachment: fixed, fixed;

      /* Neon Ä±ÅŸÄ±klar Ã¼stte */
      background-color: #07051a;
      background-blend-mode: normal;

      min-height:100vh;
      overflow-x:hidden;
    }

    /* Body neon Ä±ÅŸÄ±k parÄ±ltÄ±larÄ± */
    body::before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background:
        radial-gradient(1100px 700px at 18% 18%, rgba(180,92,255,.18), transparent 55%),
        radial-gradient(1000px 650px at 85% 22%, rgba(67,183,255,.22), transparent 55%),
        radial-gradient(1200px 900px at 50% 92%, rgba(255,79,216,.08), transparent 62%);
      z-index:-1;
    }

    .wrap{ max-width:1200px; margin:0 auto; padding:18px 14px 24px; }

    /* ===== Neon Frame ===== */
    .neonFrame{
      position:relative;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(8,7,22,.78), rgba(8,7,22,.58));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .neonFrame::before{
      content:"";
      position:absolute; inset:-2px;
      background: conic-gradient(from 200deg,
        rgba(67,183,255,.0),
        rgba(67,183,255,.88),
        rgba(180,92,255,.88),
        rgba(255,79,216,.55),
        rgba(67,183,255,.88),
        rgba(67,183,255,.0)
      );
      filter: blur(8px);
      opacity:.90;
      z-index:0;
    }
    .neonFrame::after{
      content:"";
      position:absolute; inset:1px;
      border-radius: calc(var(--radius) - 2px);
      background:
        radial-gradient(900px 500px at 22% 0%, rgba(67,183,255,.10), transparent 60%),
        radial-gradient(900px 500px at 85% 10%, rgba(180,92,255,.12), transparent 60%),
        linear-gradient(180deg, rgba(8,7,22,.82), rgba(8,7,22,.58));
      z-index:0;
    }
    .content{ position:relative; z-index:1; padding:14px; }

    /* Skor tablosu paneline Ã¶zel: mavi parlak neon + gÃ¶rsel dokusu */
    .lbFrame::before{
      opacity:1;
      filter: blur(9px);
      background: conic-gradient(from 220deg,
        rgba(67,183,255,.0),
        rgba(67,183,255,.95),
        rgba(67,183,255,.65),
        rgba(67,183,255,.95),
        rgba(67,183,255,.0)
      );
    }
    .lbFrame::after{
      background:
        linear-gradient(180deg, rgba(6,3,20,.72), rgba(10,8,48,.62)),
        radial-gradient(900px 520px at 30% 0%, rgba(67,183,255,.16), transparent 60%),
        radial-gradient(900px 520px at 85% 10%, rgba(67,183,255,.12), transparent 60%),
        var(--bgImg);
      background-size: cover, cover, cover, cover;
      background-position: center, center, center, center;
      opacity:.98;
    }

    /* ===== Header ===== */
    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:14px; flex-wrap:wrap; margin-bottom:12px;
    }
    .brand{ display:flex; align-items:center; gap:12px; user-select:none; }
    .logo{
      width:46px; height:46px; border-radius:16px;
      background:
        radial-gradient(circle at 30% 30%, rgba(180,92,255,.95), rgba(180,92,255,.18) 56%, transparent 60%),
        radial-gradient(circle at 70% 70%, rgba(67,183,255,.95), rgba(67,183,255,.18) 56%, transparent 60%),
        linear-gradient(135deg, rgba(180,92,255,.12), rgba(67,183,255,.10));
      box-shadow: var(--glowBlue), var(--glowPurple);
      border:1px solid rgba(67,183,255,.28);
    }
    .title h1{
      margin:0;
      font-size:18px;
      font-weight:1000;
      letter-spacing:.2px;
      text-shadow: 0 0 18px rgba(67,183,255,.18);
    }
    .title small{
      display:block;
      margin-top:4px;
      color:var(--muted);
      font-weight:900;
      font-size:12px;
    }

    /* ===== Pills (Audio) ===== */
    .controls{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .pill{
      display:flex; align-items:center; gap:10px;
      padding:10px 12px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(67,183,255,.22);
      box-shadow: 0 0 0 1px rgba(180,92,255,.08) inset, var(--glowBlue);
      backdrop-filter: blur(6px);
    }
    .pill label{
      font-size:12px;
      color:var(--muted);
      font-weight:1000;
      white-space:nowrap;
    }
    input[type="range"]{
      width:160px;
      accent-color: var(--purple);
    }
    .btn{
      border:none; cursor:pointer;
      font-weight:1000;
      padding:8px 12px;
      border-radius: 999px;
      color:var(--text);
      background: rgba(0,0,0,.18);
      border:1px solid rgba(180,92,255,.40);
      box-shadow: var(--glowPurple);
      transition: transform .06s ease, filter .2s ease;
    }
    .btn:hover{ filter:brightness(1.10); }
    .btn:active{ transform: translateY(1px); }

    /* ===== Layout ===== */
    .grid{
      display:grid;
      grid-template-columns: 1.35fr .65fr;
      gap:14px;
      align-items:start;
    }
    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
      input[type="range"]{ width:170px; }
    }

    .hdrRow{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; flex-wrap:wrap;
      padding:10px 12px;
    }
    .hdrRow h2{
      margin:0;
      font-size:14px;
      font-weight:1000;
      letter-spacing:.2px;
      color:var(--text);
      text-shadow: 0 0 16px rgba(67,183,255,.14);
    }

    .badges{ display:flex; gap:8px; flex-wrap:wrap; }
    .badge{
      padding:7px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:1000;
      background: rgba(0,0,0,.18);
      border:1px solid rgba(67,183,255,.22);
      box-shadow: var(--glowBlue);
      white-space:nowrap;
    }
    .divider{
      height:1px;
      background: linear-gradient(90deg, transparent, rgba(67,183,255,.46), rgba(180,92,255,.40), transparent);
      margin:0 12px 10px;
      opacity:.90;
    }

    /* ===== Start Panel ===== */
    .startRow{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      padding:0 12px 12px;
    }
    @media (max-width: 680px){ .startRow{ grid-template-columns:1fr; } }

    .field label{
      display:block;
      font-size:12px;
      color:var(--muted);
      font-weight:1000;
      margin:0 0 6px;
    }
    .field input{
      width:100%;
      padding:12px 12px;
      border-radius: 14px;
      border:1px solid rgba(67,183,255,.18);
      background: rgba(0,0,0,.22);
      color:var(--text);
      outline:none;
      font-weight:1000;
      letter-spacing:.2px;
      box-shadow: 0 0 0 1px rgba(180,92,255,.08) inset;
    }

    .modes{ display:flex; gap:10px; flex-wrap:wrap; }
    .modeBtn{
      flex:1 1 90px;
      padding:10px 10px;
      border-radius: 16px;
      border:1px solid rgba(67,183,255,.22);
      background: rgba(0,0,0,.18);
      color:var(--text);
      font-weight:1000;
      cursor:pointer;
      text-align:center;
      box-shadow: var(--glowBlue);
      transition: transform .06s ease, filter .2s ease, border-color .2s ease, box-shadow .2s ease;
      user-select:none;
    }
    .modeBtn:hover{ filter:brightness(1.08); }
    .modeBtn:active{ transform: translateY(1px); }
    .modeBtn.active{
      border-color: rgba(180,92,255,.72);
      box-shadow: 0 0 0 1px rgba(180,92,255,.22) inset, var(--glowPurple), var(--glowBlue);
    }

    .startFooter{
      display:flex;
      justify-content:flex-end;
      gap:10px;
      padding:0 12px 12px;
    }
    .startBtn{
      border:none; cursor:pointer;
      padding:12px 18px;
      border-radius: 16px;
      font-weight:1100;
      letter-spacing:.2px;
      color:var(--text);
      background: rgba(0,0,0,.22);
      border:1px solid rgba(180,92,255,.72);
      box-shadow: 0 0 0 1px rgba(180,92,255,.20) inset, var(--glowPurple);
      transition: transform .06s ease, filter .2s ease;
    }
    .startBtn:hover{ filter:brightness(1.10); }
    .startBtn:active{ transform: translateY(1px); }

    /* ===== Quiz Panel ===== */
    .qbox{
      margin:0 12px 12px;
      padding:14px;
      border-radius: 18px;
      border:1px solid rgba(67,183,255,.18);
      background: rgba(0,0,0,.18);
      box-shadow: var(--glowBlue);
      min-height: 240px;
      position:relative;
      overflow:hidden;
    }

    .qbox.flashGood::before,
    .qbox.flashBad::before{
      content:"";
      position:absolute; inset:-2px;
      filter: blur(10px);
      opacity:.55;
      pointer-events:none;
    }
    .qbox.flashGood::before{ background: radial-gradient(circle at 50% 10%, rgba(34,197,94,.55), transparent 60%); }
    .qbox.flashBad::before{ background: radial-gradient(circle at 50% 10%, rgba(239,68,68,.55), transparent 60%); }

    .qTop{ display:flex; justify-content:space-between; gap:10px; margin-bottom:10px; }
    .qIdx{ font-weight:1000; color:var(--muted); font-size:12px; }
    .qText{
      margin:6px 0 0;
      font-size:19px;
      font-weight:1100;
      line-height:1.25;
      letter-spacing:.1px;
      color: var(--text);
      text-shadow: 0 0 18px rgba(67,183,255,.10);
    }
    @media (max-width: 520px){ .qText{ font-size:17.5px; } }

    .opts{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
      margin-top:12px;
    }
    @media (max-width: 650px){ .opts{ grid-template-columns:1fr; } }

    .opt{
      padding:12px 12px;
      border-radius:16px;
      border:1px solid rgba(67,183,255,.18);
      background: rgba(0,0,0,.18);
      cursor:pointer;
      font-weight:1000;
      line-height:1.2;
      transition: transform .06s ease, border-color .16s ease, box-shadow .16s ease, filter .16s ease;
      user-select:none;
      color: var(--text);
      box-shadow: 0 0 0 1px rgba(180,92,255,.06) inset;
    }
    .opt:hover{
      filter:brightness(1.06);
      border-color: rgba(67,183,255,.46);
      box-shadow: var(--glowBlueStrong);
    }
    .opt:active{ transform: translateY(1px); }
    .opt .k{
      display:inline-block;
      min-width:26px;
      margin-right:6px;
      color: rgba(180,92,255,.96);
      text-shadow: 0 0 14px rgba(180,92,255,.18);
    }
    .opt.correct{
      border-color: rgba(34,197,94,.72);
      box-shadow: 0 0 0 1px rgba(34,197,94,.15) inset, 0 0 28px rgba(34,197,94,.16);
      background: rgba(34,197,94,.10);
    }
    .opt.wrong{
      border-color: rgba(239,68,68,.72);
      box-shadow: 0 0 0 1px rgba(239,68,68,.15) inset, 0 0 28px rgba(239,68,68,.16);
      background: rgba(239,68,68,.10);
    }
    .opt.disabled{ pointer-events:none; opacity:.93; }

    .mini{
      margin-top:10px;
      color:var(--muted);
      font-weight:900;
      font-size:12px;
    }

    .feedback{
      margin-top:10px;
      font-weight:1100;
      font-size:13px;
      letter-spacing:.2px;
      text-shadow: 0 0 14px rgba(67,183,255,.14);
      min-height:18px;
    }
    .feedback.good{ color: rgba(34,197,94,.95); text-shadow: 0 0 14px rgba(34,197,94,.18); }
    .feedback.bad{ color: rgba(239,68,68,.95); text-shadow: 0 0 14px rgba(239,68,68,.18); }

    /* ===== Finish Panel ===== */
    .finishPanel{
      margin:0 12px 12px;
      padding:14px;
      border-radius: 18px;
      border:1px solid rgba(180,92,255,.24);
      background: rgba(0,0,0,.18);
      box-shadow: var(--glowPurple);
      display:none;
    }
    .finishTitle{
      margin:0 0 8px;
      font-size:16px;
      font-weight:1100;
      letter-spacing:.2px;
      text-shadow: 0 0 18px rgba(180,92,255,.14);
    }
    .finishGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:8px;
    }
    @media (max-width: 520px){ .finishGrid{ grid-template-columns:1fr; } }
    .stat{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(67,183,255,.16);
      background: rgba(0,0,0,.14);
      box-shadow: var(--glowBlue);
      font-weight:1000;
      color:var(--text);
    }
    .stat small{ display:block; color:var(--muted); font-weight:900; margin-bottom:4px; }
    .finishBtns{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
      margin-top:12px;
    }
    .btnPrimary{
      border:none; cursor:pointer;
      padding:12px 14px;
      border-radius: 14px;
      font-weight:1100;
      color:var(--text);
      background: rgba(0,0,0,.22);
      border:1px solid rgba(67,183,255,.56);
      box-shadow: var(--glowBlueStrong);
    }
    .btnGhost{
      border:none; cursor:pointer;
      padding:12px 14px;
      border-radius: 14px;
      font-weight:1100;
      color:var(--text);
      background: rgba(0,0,0,.16);
      border:1px solid rgba(180,92,255,.40);
      box-shadow: var(--glowPurple);
    }
    .btnPrimary:active,.btnGhost:active{ transform: translateY(1px); }

    /* ===== Leaderboard ===== */
    .tabs{ display:flex; gap:8px; flex-wrap:wrap; padding:0 12px 10px; }
    .tab{
      padding:8px 10px;
      border-radius:14px;
      border:1px solid rgba(67,183,255,.18);
      background: rgba(0,0,0,.16);
      color:var(--text);
      cursor:pointer;
      font-weight:1000;
      font-size:12px;
      user-select:none;
      box-shadow: var(--glowBlue);
    }
    .tab.active{
      border-color: rgba(67,183,255,.88);
      box-shadow: var(--glowBlueStrong);
    }

    .tableWrap{
      margin:0 12px 12px;
      overflow:auto;
      border-radius: 16px;
      border:1px solid rgba(67,183,255,.22);
      background: rgba(0,0,0,.14);
      box-shadow: var(--glowBlueStrong);
    }
    table{ width:100%; border-collapse:collapse; }
    th, td{
      padding:10px 8px;
      border-bottom:1px solid rgba(67,183,255,.10);
      text-align:left;
      font-size:12px;
      font-weight:1000;
      color:var(--text);
      vertical-align:top;
      white-space:nowrap;
    }
    th{ color:var(--muted); }
    .right{ text-align:right; }

    /* Toast */
    .toast{
      position:fixed;
      left:50%;
      transform:translateX(-50%);
      bottom:14px;
      background: rgba(8,7,22,.92);
      border:1px solid rgba(67,183,255,.20);
      box-shadow: 0 12px 40px rgba(0,0,0,.55);
      padding:10px 12px;
      border-radius:14px;
      font-weight:1000;
      font-size:12px;
      color:var(--text);
      opacity:0;
      pointer-events:none;
      transition: opacity .2s ease, transform .2s ease;
      z-index:9999;
      max-width:min(720px, 92vw);
    }
    .toast.show{ opacity:1; transform:translateX(-50%) translateY(-4px); }

    /* Confetti */
    #confetti{ position:fixed; inset:0; pointer-events:none; z-index:9998; }
  </style>
</head>

<body>
<canvas id="confetti"></canvas>

<div class="wrap">
  <div class="topbar">
    <!-- Mobil reset iÃ§in: logoya 6 sn basÄ±lÄ± tut -->
    <div class="brand">
      <div class="logo" id="teacherReset"></div>
      <div class="title">
        <h1>HÃ¼seyin AkdaÄŸ Ä°lkokulu Fen Bilimleri 4. Tema YarÄ±ÅŸmasÄ±</h1>
        <small>Pro+ â€¢ 10/20/30/40 soru â€¢ Skor â€¢ SÃ¼re</small>
      </div>
    </div>

    <div class="controls">
      <div class="pill">
        <label>ðŸŽµ MÃ¼zik</label>
        <input id="musicVol" type="range" min="0" max="1" step="0.01" value="0.35">
        <button id="musicToggle" class="btn" type="button">AÃ§Ä±k</button>
      </div>
      <div class="pill">
        <label>ðŸ”Š Efekt</label>
        <input id="fxVol" type="range" min="0" max="1" step="0.01" value="0.60">
        <button id="fxToggle" class="btn" type="button">AÃ§Ä±k</button>
      </div>
    </div>
  </div>

  <div class="grid">
    <!-- Oyun -->
    <div class="neonFrame">
      <div class="content">
        <div class="hdrRow">
          <h2>Oyun</h2>
          <div class="badges">
            <span id="bMode" class="badge">Mod: -</span>
            <span id="bScore" class="badge">Skor: 0</span>
            <span id="bTime" class="badge">SÃ¼re: 0 sn</span>
          </div>
        </div>
        <div class="divider"></div>

        <div id="startPanel">
          <div class="startRow">
            <div class="field">
              <label>Ã–ÄŸrenci AdÄ±</label>
              <input id="playerName" placeholder="" maxlength="18" />
            </div>

            <div class="field">
              <label>Soru SayÄ±sÄ± (Mod)</label>
              <div class="modes" id="modeButtons"></div>
            </div>
          </div>

          <div class="startFooter">
            <button id="btnStart" class="startBtn" type="button">BaÅŸlat</button>
          </div>
        </div>

        <div id="quizPanel" style="display:none;">
          <div class="qbox" id="qbox">
            <div class="qTop">
              <div class="qIdx" id="qIndex">Soru -/-</div>
              <div class="qIdx" id="qHint"></div>
            </div>

            <div class="qText" id="qText">...</div>
            <div class="opts" id="opts"></div>

            <div class="mini" id="miniProgress">-</div>
            <div class="feedback" id="feedback"></div>
          </div>
        </div>

        <!-- BitiÅŸ ekranÄ± -->
        <div id="finishPanel" class="finishPanel">
          <h3 class="finishTitle">Oyun Bitti ðŸŽ‰</h3>
          <div class="finishGrid">
            <div class="stat"><small>Ã–ÄŸrenci</small><span id="fName">-</span></div>
            <div class="stat"><small>Mod</small><span id="fMode">-</span></div>
            <div class="stat"><small>Skor</small><span id="fScore">-</span></div>
            <div class="stat"><small>SÃ¼re</small><span id="fTime">-</span></div>
          </div>
          <div class="finishBtns">
            <button id="btnRestart" class="btnPrimary" type="button">Yeniden BaÅŸlat</button>
            <button id="btnHome" class="btnGhost" type="button">Ana Ekran</button>
          </div>
        </div>

      </div>
    </div>

    <!-- Skor Tablosu -->
    <div class="neonFrame lbFrame">
      <div class="content">
        <div class="hdrRow">
          <h2>Skor Tablosu</h2>
          <div class="badges">
            <span class="badge">Firebase</span>
          </div>
        </div>
        <div class="divider"></div>

        <div class="tabs" id="lbTabs"></div>

        <div class="tableWrap">
          <table>
            <thead>
              <tr>
                <th>#</th>
                <th>Ä°sim</th>
                <th class="right">Skor</th>
                <th class="right">SÃ¼re</th>
              </tr>
            </thead>
            <tbody id="lbBody">
              <tr><td colspan="4" style="color:var(--muted);">YÃ¼kleniyor...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </div>
</div>

<div id="toast" class="toast"></div>

<script type="module">
  /************************************************************
   * AYARLAR
   ************************************************************/
  const ANSWER_REVEAL_MS = 1200; // doÄŸru/yanlÄ±ÅŸ efektini gÃ¶rsÃ¼n diye

  /************************************************************
   * ARKA PLAN (3 gÃ¶rsel) - her oyun baÅŸlangÄ±cÄ±nda deÄŸiÅŸir
   ************************************************************/
  const BG_LIST = ["bg1.jpg","bg2.jpg","bg3.jpg"]; // aynÄ± klasÃ¶rde olmalÄ±
  let lastBg = -1;

  function pickBg(){
    if(!BG_LIST.length) return;
    let idx = Math.floor(Math.random()*BG_LIST.length);
    if(BG_LIST.length > 1 && idx === lastBg) idx = (idx+1) % BG_LIST.length;
    lastBg = idx;
    document.documentElement.style.setProperty("--bgImg", `url('${BG_LIST[idx]}')`);
  }

  // sayfa aÃ§Ä±lÄ±nca bir tane seÃ§
  pickBg();

  /************************************************************
   * FIREBASE CONFIG (BURAYI DOLDUR)
   ************************************************************/
  const firebaseConfig = {
    apiKey: "AIzaSyDlrVdLo7ZMqhLJb-xoImcFKuLC65v_20Y",
    authDomain: "dort-islem-oyunu-608cb.firebaseapp.com",
    projectId: "dort-islem-oyunu-608cb",
    storageBucket: "dort-islem-oyunu-608cb.firebasestorage.app",
    messagingSenderId: "133255919254",
    appId: "1:133255919254:web:19b73a36e9b76d4d0a34b7",
    measurementId: "G-J0693K6LVX"
  };
  /************************************************************
   * SORU BANKASI
   * (Senin bank dizin aynen burada. AÅŸaÄŸÄ±ya mevcut bankâ€™Ä±nÄ± olduÄŸu gibi koydum.)
   ************************************************************/
  const BANK = [
    {q:"AÅŸaÄŸÄ±dakilerden hangisi maddeyi nitelendiren Ã¶zelliklerden biri deÄŸildir?", a:["Suda yÃ¼zme","MÄ±knatÄ±sla Ã§ekilme","KÃ¼tle","Suyu emme"], c:"C"},
    {q:"Suya atÄ±ldÄ±ÄŸÄ±nda yÃ¼zen bir madde aÅŸaÄŸÄ±dakilerden hangisi olamaz?", a:["Tahta parÃ§asÄ±","Plastik kapak","TaÅŸ","Pinpon topu"], c:"C"},
    {q:"AÅŸaÄŸÄ±daki maddelerden hangisi suyu emer?", a:["AlÃ¼minyum folyo","Havlu","Cam bardak","Plastik ÅŸiÅŸe"], c:"B"},
    {q:"MÄ±knatÄ±s tarafÄ±ndan Ã§ekilen maddeler aÅŸaÄŸÄ±dakilerden hangisidir?", a:["Cam, plastik, altÄ±n","Demir, nikel, kobalt","Tahta, kaÄŸÄ±t, pamuk","AlÃ¼minyum, bakÄ±r, gÃ¼mÃ¼ÅŸ"], c:"B"},
    {q:"AÅŸaÄŸÄ±daki maddelerden hangisi hem suda yÃ¼zer hem de mÄ±knatÄ±sla Ã§ekilmez?", a:["Metal kapak","Plastik top","Ã‡elik Ã§ivi","AlÃ¼minyum folyo"], c:"B"},
    {q:"DeÄŸiÅŸmeyen madde miktarÄ±na ne denir?", a:["Hacim","KÃ¼tle","AÄŸÄ±rlÄ±k","BrÃ¼t kÃ¼tle"], c:"B"},
    {q:"AÅŸaÄŸÄ±daki Ã¶lÃ§Ã¼ birimlerinden hangisi kÃ¼tle iÃ§in kullanÄ±lmaz?", a:["Kilogram","Gram","Litre","Miligram"], c:"C"},
    {q:"SÄ±vÄ± bir maddenin net kÃ¼tlesini bulmak iÃ§in aÅŸaÄŸÄ±daki formÃ¼lden hangisi kullanÄ±lÄ±r?", a:["BrÃ¼t kÃ¼tle + Dara","BrÃ¼t kÃ¼tle â€“ Dara","Net kÃ¼tle â€“ Dara","Net kÃ¼tle + BrÃ¼t kÃ¼tle"], c:"B"},
    {q:"Bir kabÄ±n boÅŸken kÃ¼tlesi 150 g, iÃ§i suyla doluyken kÃ¼tlesi 500 gâ€™dÄ±r. Suyun net kÃ¼tlesi kaÃ§ gramdÄ±r?", a:["350","500","650","150"], c:"A"},
    {q:"SÄ±vÄ±larÄ±n hacmini Ã¶lÃ§mek iÃ§in aÅŸaÄŸÄ±dakilerden hangisi kullanÄ±lmaz?", a:["Dereceli silindir","Terazi","Ã–lÃ§Ã¼lÃ¼ kap","Beher"], c:"B"},
    {q:"1 litre kaÃ§ mililitredir?", a:["10","100","1000","10000"], c:"C"},
    {q:"Dereceli bir kapta 300 ml su vardÄ±r. Ä°Ã§ine bir taÅŸ atÄ±ldÄ±ÄŸÄ±nda su seviyesi 450 mlâ€™ye Ã§Ä±kÄ±yor. TaÅŸÄ±n hacmi kaÃ§ mlâ€™dir?", a:["150","300","450","750"], c:"A"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi madde deÄŸildir?", a:["Hava","IÅŸÄ±k","Su","TaÅŸ"], c:"B"},
    {q:"Maddeler doÄŸada kaÃ§ halde bulunur?", a:["2","3","4","5"], c:"B"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi katÄ± maddelerin Ã¶zelliÄŸi deÄŸildir?", a:["Belirli bir ÅŸekli vardÄ±r.","AkÄ±ÅŸkandÄ±r.","SÄ±kÄ±ÅŸtÄ±rÄ±lamaz.","DÄ±ÅŸ etki olmadan ÅŸekli deÄŸiÅŸmez."], c:"B"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi sÄ±vÄ± maddelerin Ã¶zelliÄŸidir?", a:["Belirli bir ÅŸekli yoktur.","SÄ±kÄ±ÅŸtÄ±rÄ±labilir.","Taneleri akÄ±ÅŸkan deÄŸildir.","Hacmi yoktur."], c:"A"},
    {q:"Gaz maddelerle ilgili aÅŸaÄŸÄ±dakilerden hangisi yanlÄ±ÅŸtÄ±r?", a:["BulunduklarÄ± kabÄ±n ÅŸeklini alÄ±rlar.","SÄ±kÄ±ÅŸtÄ±rÄ±labilirler.","Belirli bir hacimleri yoktur.","AkÄ±ÅŸkan deÄŸillerdir."], c:"D"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi gaz maddelere Ã¶rnek deÄŸildir?", a:["Oksijen","Su buharÄ±","Tahta","DoÄŸal gaz"], c:"C"},
    {q:"Mercimek, pirinÃ§, bulgur gibi maddeler hangi haldedir?", a:["KatÄ±","SÄ±vÄ±","Gaz","Plazma"], c:"A"},
    {q:"IsÄ± alan maddenin sÄ±caklÄ±ÄŸÄ± nasÄ±l deÄŸiÅŸir?", a:["Artar","AzalÄ±r","DeÄŸiÅŸmez","Ã–nce artar sonra azalÄ±r"], c:"A"},
    {q:"AÅŸaÄŸÄ±daki olaylardan hangisi maddenin Ä±sÄ± vererek gerÃ§ekleÅŸtirdiÄŸi bir deÄŸiÅŸimdir?", a:["Erime","BuharlaÅŸma","Donma","IsÄ±nma"], c:"C"},
    {q:"KatÄ± haldeki bir maddenin Ä±sÄ± alarak sÄ±vÄ± hale geÃ§mesine ne denir?", a:["Donma","BuharlaÅŸma","Erime","YoÄŸuÅŸma"], c:"C"},
    {q:"SÄ±vÄ± haldeki bir maddenin Ä±sÄ± vererek katÄ± hale geÃ§mesine ne denir?", a:["Erime","Donma","BuharlaÅŸma","YoÄŸuÅŸma"], c:"B"},
    {q:"SÄ±vÄ± haldeki bir maddenin Ä±sÄ± alarak gaz haline geÃ§mesine ne denir?", a:["Donma","YoÄŸuÅŸma","Erime","BuharlaÅŸma"], c:"D"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi buharlaÅŸmaya Ã¶rnek deÄŸildir?", a:["Ã‡amaÅŸÄ±rlarÄ±n kurumasÄ±","Deniz suyunun buharlaÅŸmasÄ±","KolonyanÄ±n el Ã¼zerinde soÄŸukluk hissi vermesi","Suyun donarak buz olmasÄ±"], c:"D"},
    {q:"BuzdolabÄ±ndan Ã§Ä±karÄ±lan su ÅŸiÅŸesinin dÄ±ÅŸÄ±nda su damlacÄ±klarÄ± oluÅŸmasÄ± hangi olaya Ã¶rnektir?", a:["Erime","Donma","BuharlaÅŸma","YoÄŸuÅŸma"], c:"D"},
    {q:"Saf maddelerle ilgili aÅŸaÄŸÄ±dakilerden hangisi yanlÄ±ÅŸtÄ±r?", a:["Tek tÃ¼r maddeden oluÅŸurlar.","Her noktasÄ± aynÄ± Ã¶zelliktedir.","KarÄ±ÅŸÄ±mlara ayrÄ±labilirler.","Åžeker, tuz, altÄ±n Ã¶rnek verilebilir."], c:"C"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi saf madde deÄŸildir?", a:["Su","Tuz","Limonata","AltÄ±n"], c:"C"},
    {q:"Ä°ki ya da daha fazla saf maddenin bir araya gelmesiyle oluÅŸan maddelere ne denir?", a:["Element","BileÅŸik","KarÄ±ÅŸÄ±m","Ã‡Ã¶zelti"], c:"C"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi karÄ±ÅŸÄ±ma Ã¶rnek deÄŸildir?", a:["Salata","Ayran","Su","Ã‡orba"], c:"C"},
    {q:"KarÄ±ÅŸÄ±mlarÄ± ayÄ±rmada kullanÄ±lan yÃ¶ntemlerden hangisi katÄ±-katÄ± karÄ±ÅŸÄ±mlarÄ± iÃ§in uygundur?", a:["SÃ¼zme","Eleme","BuharlaÅŸtÄ±rma","DamÄ±tma"], c:"B"},
    {q:"PirinÃ§-su karÄ±ÅŸÄ±mÄ±nÄ± ayÄ±rmak iÃ§in hangi yÃ¶ntem kullanÄ±lÄ±r?", a:["Eleme","SÃ¼zme","MÄ±knatÄ±sla ayÄ±rma","YÃ¼zdÃ¼rme"], c:"B"},
    {q:"Demir tozu-kum karÄ±ÅŸÄ±mÄ±nÄ± ayÄ±rmak iÃ§in en uygun yÃ¶ntem hangisidir?", a:["Eleme","SÃ¼zme","MÄ±knatÄ±sla ayÄ±rma","BuharlaÅŸtÄ±rma"], c:"C"},
    {q:"AÅŸaÄŸÄ±daki karÄ±ÅŸÄ±mlardan hangisi eleme yÃ¶ntemiyle ayrÄ±labilir?", a:["Tuz-su","Un-nohut","Åžeker-su","ZeytinyaÄŸÄ±-su"], c:"B"},
    {q:"Geri dÃ¶nÃ¼ÅŸÃ¼m kutularÄ±ndan mavi renkli olan hangi atÄ±klar iÃ§indir?", a:["Plastik","KaÄŸÄ±t","Cam","Metal"], c:"B"},
    {q:"SarÄ± geri dÃ¶nÃ¼ÅŸÃ¼m kutusu hangi atÄ±klar iÃ§in kullanÄ±lÄ±r?", a:["Cam","KaÄŸÄ±t","Plastik","Organik atÄ±k"], c:"C"},
    {q:"Geri dÃ¶nÃ¼ÅŸÃ¼mÃ¼n faydalarÄ±ndan biri deÄŸildir?", a:["DoÄŸal kaynaklarÄ± korur.","Enerji tasarrufu saÄŸlar.","AtÄ±k miktarÄ±nÄ± artÄ±rÄ±r.","Ekonomiye katkÄ± saÄŸlar."], c:"C"},
    {q:"AÅŸaÄŸÄ±daki maddelerden hangisi suyu emmez?", a:["SÃ¼nger","Pamuk","Cam bardak","Havlu"], c:"C"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi mÄ±knatÄ±s tarafÄ±ndan Ã§ekilmez?", a:["Ã‡ivi","Toplu iÄŸne","AlÃ¼minyum folyo","Demir para"], c:"C"},
    {q:"Bir maddenin boÅŸlukta kapladÄ±ÄŸÄ± yere ne denir?", a:["KÃ¼tle","Hacim","AÄŸÄ±rlÄ±k","YoÄŸunluk"], c:"B"},
    {q:"SÄ±vÄ±larÄ±n hacim birimi aÅŸaÄŸÄ±dakilerden hangisidir?", a:["Kilogram","Gram","Litre","Metre"], c:"C"},
    {q:"KatÄ± maddelerin kÃ¼tlesi hangi araÃ§la Ã¶lÃ§Ã¼lÃ¼r?", a:["Dereceli silindir","Terazi","Termometre","Cetvel"], c:"B"},
    {q:"Gaz maddelerin Ã¶zelliklerinden biri deÄŸildir?", a:["SÄ±kÄ±ÅŸtÄ±rÄ±labilir.","Belirli bir ÅŸekli yoktur.","AkÄ±ÅŸkandÄ±r.","Belirli bir hacmi vardÄ±r."], c:"D"},
    {q:"Suyun katÄ± hali aÅŸaÄŸÄ±dakilerden hangisidir?", a:["Su buharÄ±","Bulut","Buz","YaÄŸmur"], c:"C"},
    {q:"Suyun gaz hali aÅŸaÄŸÄ±dakilerden hangisidir?", a:["Kar","Dolu","Su buharÄ±","Ã‡iy"], c:"C"},
    {q:"IsÄ± veren maddenin sÄ±caklÄ±ÄŸÄ± nasÄ±l deÄŸiÅŸir?", a:["Artar","AzalÄ±r","DeÄŸiÅŸmez","Ã–nce artar sonra azalÄ±r"], c:"B"},
    {q:"AÅŸaÄŸÄ±daki maddelerden hangisi saf madde deÄŸildir?", a:["BakÄ±r tel","Åžeker","Tuzlu su","Oksijen gazÄ±"], c:"C"},
    {q:"KarÄ±ÅŸÄ±mlarla ilgili aÅŸaÄŸÄ±dakilerden hangisi doÄŸrudur?", a:["KarÄ±ÅŸÄ±mÄ± oluÅŸturan maddeler Ã¶zelliklerini kaybeder.","KarÄ±ÅŸÄ±mlar sadece katÄ± halde olur.","KarÄ±ÅŸÄ±mlar en az iki saf maddenin birleÅŸmesiyle oluÅŸur.","KarÄ±ÅŸÄ±mlar her zaman gÃ¶zle gÃ¶rÃ¼lÃ¼r."], c:"C"},
    {q:"Un iÃ§indeki kepeÄŸi ayÄ±rmak iÃ§in hangi yÃ¶ntem kullanÄ±lÄ±r?", a:["SÃ¼zme","Eleme","MÄ±knatÄ±sla ayÄ±rma","YÃ¼zdÃ¼rme"], c:"B"},
    {q:"Demir tozu ve talaÅŸ karÄ±ÅŸÄ±mÄ±nÄ± ayÄ±rmak iÃ§in hangi yÃ¶ntem uygundur?", a:["Eleme","SÃ¼zme","MÄ±knatÄ±sla ayÄ±rma","BuharlaÅŸtÄ±rma"], c:"C"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi suda batar?", a:["Plastik ÅŸiÅŸe","Tahta parÃ§asÄ±","TaÅŸ","Pinpon topu"], c:"C"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi suda yÃ¼zer?", a:["Ã‡elik kaÅŸÄ±k","Metal para","Tahta","Anahtar"], c:"C"},
    {q:"Su geÃ§irmeyen kÄ±yafetler hangi Ã¶zellikteki maddelerden yapÄ±lÄ±r?", a:["Suyu emen","Suyu emmeyen","Suda batan","MÄ±knatÄ±sla Ã§ekilen"], c:"B"},
    {q:"HurdalÄ±klarda metalleri ayÄ±rmak iÃ§in hangi Ã¶zellikten yararlanÄ±lÄ±r?", a:["Suda yÃ¼zme","Suyu emme","MÄ±knatÄ±sla Ã§ekilme","Hacim"], c:"C"},
    {q:"KÃ¼tle Ã¶lÃ§Ã¼mÃ¼nde kullanÄ±lan birim aÅŸaÄŸÄ±dakilerden hangisidir?", a:["Litre","Metre","Kilogram","Santimetre"], c:"C"},
    {q:"1 kilogram kaÃ§ gramdÄ±r?", a:["10","100","1000","10000"], c:"C"},
    {q:"SÄ±vÄ±larÄ±n kÃ¼tlesini Ã¶lÃ§erken aÅŸaÄŸÄ±dakilerden hangisi yapÄ±lÄ±r?", a:["SÄ±vÄ± direkt teraziye konur.","BoÅŸ kabÄ±n kÃ¼tlesi Ã¶lÃ§Ã¼lÃ¼r.","SÄ±vÄ±nÄ±n hacmi Ã¶lÃ§Ã¼lÃ¼r.","SÄ±vÄ±nÄ±n rengine bakÄ±lÄ±r."], c:"B"},
    {q:"BrÃ¼t kÃ¼tle ne demektir?", a:["SÄ±vÄ±nÄ±n net kÃ¼tlesi","KabÄ±n kÃ¼tlesi","SÄ±vÄ± ve kabÄ±n toplam kÃ¼tlesi","SÄ±vÄ±nÄ±n hacmi"], c:"C"},
    {q:"Dara neyi ifade eder?", a:["SÄ±vÄ±nÄ±n kÃ¼tlesi","KabÄ±n kÃ¼tlesi","Toplam kÃ¼tle","SÄ±vÄ±nÄ±n hacmi"], c:"B"},
    {q:"Hacim Ã¶lÃ§mek iÃ§in kullanÄ±lan araÃ§lardan biri deÄŸildir?", a:["Dereceli silindir","Terazi","Ã–lÃ§Ã¼lÃ¼ kap","Beher"], c:"B"},
    {q:"KatÄ± bir cismin hacmi nasÄ±l Ã¶lÃ§Ã¼lÃ¼r?", a:["Dereceli kaptaki suyun yÃ¼kselme miktarÄ±ndan","Terazide tartarak","Cetvelle Ã¶lÃ§erek","GÃ¶zle tahmin ederek"], c:"A"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi madde deÄŸildir?", a:["Hava","Su","IÅŸÄ±k","Toprak"], c:"C"},
    {q:"Maddelerin ortak Ã¶zellikleri aÅŸaÄŸÄ±dakilerden hangisidir?", a:["KÃ¼tle ve hacim","Renk ve koku","Suda yÃ¼zme","MÄ±knatÄ±sla Ã§ekilme"], c:"A"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi katÄ± maddelerin Ã¶zelliÄŸidir?", a:["KonulduÄŸu kabÄ±n ÅŸeklini alÄ±r.","Belirli bir ÅŸekli yoktur.","Belirli bir ÅŸekli vardÄ±r.","SÄ±kÄ±ÅŸtÄ±rÄ±labilir."], c:"C"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi sÄ±vÄ± maddelerin Ã¶zelliÄŸi deÄŸildir?", a:["AkÄ±ÅŸkandÄ±r.","Belirli bir hacmi vardÄ±r.","Belirli bir ÅŸekli yoktur.","SÄ±kÄ±ÅŸtÄ±rÄ±labilir."], c:"D"},
    {q:"Gaz maddelerle ilgili doÄŸru ifade hangisidir?", a:["Belirli bir hacimleri yoktur.","Belirli bir ÅŸekilleri vardÄ±r.","SÄ±kÄ±ÅŸtÄ±rÄ±lamazlar.","AkÄ±ÅŸkan deÄŸillerdir."], c:"A"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi katÄ± maddelere Ã¶rnektir?", a:["Su","Hava","TaÅŸ","Su buharÄ±"], c:"C"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi sÄ±vÄ± maddelere Ã¶rnektir?", a:["Buz","ZeytinyaÄŸÄ±","Oksijen","Demir"], c:"B"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi gaz maddelere Ã¶rnektir?", a:["Tahta","Su","Karbondioksit","Tuz"], c:"C"},
    {q:"IsÄ± alÄ±ÅŸveriÅŸi hangi yÃ¶nde gerÃ§ekleÅŸir?", a:["SoÄŸuk maddeden sÄ±cak maddeye","SÄ±cak maddeden soÄŸuk maddeye","Her iki yÃ¶nde de","IsÄ± alÄ±ÅŸveriÅŸi olmaz"], c:"B"},
    {q:"SÄ±caklÄ±ÄŸÄ± Ã¶lÃ§en aletin adÄ± nedir?", a:["Barometre","Termometre","Higrometre","Anemometre"], c:"B"},
    {q:"SÄ±caklÄ±k birimi nedir?", a:["Kilogram","Litre","Derece Celsius","Gram"], c:"C"},
    {q:"Donma olayÄ±nda madde ne yapar?", a:["IsÄ± alÄ±r","IsÄ± verir","SÄ±caklÄ±ÄŸÄ± artar","Hacmi artar"], c:"B"},
    {q:"BuharlaÅŸma olayÄ±nda madde ne yapar?", a:["IsÄ± alÄ±r","IsÄ± verir","SÄ±caklÄ±ÄŸÄ± dÃ¼ÅŸer","Hacmi azalÄ±r"], c:"A"},
    {q:"Erime olayÄ±nda madde ne yapar?", a:["IsÄ± alÄ±r","IsÄ± verir","SÄ±caklÄ±ÄŸÄ± dÃ¼ÅŸer","Hacmi artar"], c:"A"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi erimeye Ã¶rnektir?", a:["Suyun buz olmasÄ±","DondurmanÄ±n erimesi","Suyun kaynamasÄ±","Ã‡amaÅŸÄ±rlarÄ±n kurumasÄ±"], c:"B"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi donmaya Ã¶rnektir?", a:["Suyun buharlaÅŸmasÄ±","Buzun erimesi","GÃ¶lÃ¼n buz tutmasÄ±","KolonyanÄ±n uÃ§masÄ±"], c:"C"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi buharlaÅŸmaya Ã¶rnektir?", a:["Suyun kaynamasÄ±","Suyun donmasÄ±","Buzun erimesi","YaÄŸmurun yaÄŸmasÄ±"], c:"A"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi yoÄŸuÅŸmaya Ã¶rnektir?", a:["Suyun buharlaÅŸmasÄ±","BuzdolabÄ±ndan Ã§Ä±kan su ÅŸiÅŸesinde damlalarÄ±n oluÅŸmasÄ±","Suyun kaynamasÄ±","DondurmanÄ±n erimesi"], c:"B"},
    {q:"Saf maddelerle ilgili aÅŸaÄŸÄ±dakilerden hangisi yanlÄ±ÅŸtÄ±r?", a:["Tek tÃ¼r maddeden oluÅŸur.","Her noktasÄ± aynÄ± Ã¶zelliktedir.","KarÄ±ÅŸÄ±mlara ayrÄ±ÅŸtÄ±rÄ±labilir.","Ã–rnek: altÄ±n, bakÄ±r, ÅŸeker"], c:"C"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi saf maddedir?", a:["Ayran","Åžeker","Limonata","Ã‡orba"], c:"B"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi karÄ±ÅŸÄ±mdÄ±r?", a:["Su","Tuz","Hava","AltÄ±n"], c:"C"},
    {q:"KarÄ±ÅŸÄ±mlarÄ± ayÄ±rma yÃ¶ntemlerinden hangisi katÄ±-sÄ±vÄ± karÄ±ÅŸÄ±mlarÄ± iÃ§in kullanÄ±lÄ±r?", a:["Eleme","SÃ¼zme","MÄ±knatÄ±sla ayÄ±rma","YÃ¼zdÃ¼rme"], c:"B"},
    {q:"Demir tozu ve kum karÄ±ÅŸÄ±mÄ±nÄ± ayÄ±rmak iÃ§in hangi yÃ¶ntem kullanÄ±lÄ±r?", a:["Eleme","SÃ¼zme","MÄ±knatÄ±sla ayÄ±rma","BuharlaÅŸtÄ±rma"], c:"C"},
    {q:"Un ve pirinÃ§ karÄ±ÅŸÄ±mÄ±nÄ± ayÄ±rmak iÃ§in hangi yÃ¶ntem kullanÄ±lÄ±r?", a:["Eleme","SÃ¼zme","MÄ±knatÄ±sla ayÄ±rma","YÃ¼zdÃ¼rme"], c:"A"},
    {q:"Ã‡ay yapraklarÄ±nÄ± Ã§aydan ayÄ±rmak iÃ§in hangi yÃ¶ntem kullanÄ±lÄ±r?", a:["Eleme","SÃ¼zme","MÄ±knatÄ±sla ayÄ±rma","BuharlaÅŸtÄ±rma"], c:"B"},
    {q:"Geri dÃ¶nÃ¼ÅŸÃ¼mÃ¼n faydalarÄ±ndan biri deÄŸildir?", a:["DoÄŸal kaynaklarÄ± tÃ¼ketir.","Enerji tasarrufu saÄŸlar.","Ã‡evre kirliliÄŸini azaltÄ±r.","Ekonomiye katkÄ± saÄŸlar."], c:"A"},
    {q:"Cam atÄ±klar hangi renk geri dÃ¶nÃ¼ÅŸÃ¼m kutusuna atÄ±lÄ±r?", a:["Mavi","SarÄ±","YeÅŸil","Gri"], c:"C"},
    {q:"Plastik atÄ±klar hangi renk geri dÃ¶nÃ¼ÅŸÃ¼m kutusuna atÄ±lÄ±r?", a:["Mavi","SarÄ±","YeÅŸil","Gri"], c:"B"},
    {q:"KaÄŸÄ±t atÄ±klar hangi renk geri dÃ¶nÃ¼ÅŸÃ¼m kutusuna atÄ±lÄ±r?", a:["Mavi","SarÄ±","YeÅŸil","Gri"], c:"A"},
    {q:"Metal atÄ±klar hangi renk geri dÃ¶nÃ¼ÅŸÃ¼m kutusuna atÄ±lÄ±r?", a:["Mavi","SarÄ±","YeÅŸil","Gri"], c:"D"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi suyu emen maddelerdendir?", a:["Plastik tabak","Cam bardak","Havlu","Metal kaÅŸÄ±k"], c:"C"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi mÄ±knatÄ±s tarafÄ±ndan Ã§ekilir?", a:["Cam","Tahta","Demir","Plastik"], c:"C"},
    {q:"KÃ¼tle Ã¶lÃ§Ã¼mÃ¼nde kullanÄ±lan araÃ§lardan biri deÄŸildir?", a:["Terazi","BaskÃ¼l","Dereceli silindir","EÅŸit kollu terazi"], c:"C"},
    {q:"Hacim Ã¶lÃ§Ã¼mÃ¼nde kullanÄ±lan araÃ§lardan biri deÄŸildir?", a:["Terazi","Dereceli silindir","Ã–lÃ§Ã¼lÃ¼ kap","Beher"], c:"A"},
    {q:"2 litre kaÃ§ mililitredir?", a:["20","200","2000","20000"], c:"C"},
    {q:"500 gram kaÃ§ kilogramdÄ±r?", a:["0,5","5","50","5000"], c:"A"},
    {q:"BrÃ¼t kÃ¼tlesi 800 g, darasÄ± 200 g olan sÄ±vÄ±nÄ±n net kÃ¼tlesi kaÃ§ gramdÄ±r?", a:["600","800","1000","200"], c:"A"},
    {q:"Bir maddenin kÃ¼tlesi ve hacmi varsa o madde iÃ§in ne sÃ¶ylenebilir?", a:["Madde deÄŸildir.","Maddedir.","Sadece katÄ±dÄ±r.","Sadece sÄ±vÄ±dÄ±r."], c:"B"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi madde deÄŸildir?", a:["Ses","TaÅŸ","Su","Hava"], c:"A"},
    {q:"Maddeleri duyu organlarÄ±mÄ±zla ayÄ±rt edebileceÄŸimiz Ã¶zelliklerden biri deÄŸildir?", a:["Renk","Koku","Tat","KÃ¼tle"], c:"D"},
    {q:"Tahta, plastik, cam gibi maddeler suda genellikle ne yapar?", a:["Batar","YÃ¼zer","Ã‡Ã¶zÃ¼nÃ¼r","SÄ±kÄ±ÅŸÄ±r"], c:"B"},
    {q:"Demir, nikel, kobalt gibi maddeler hangi Ã¶zellik gÃ¶sterir?", a:["Suyu emer","MÄ±knatÄ±sla Ã§ekilir","Suda yÃ¼zer","Suda batar"], c:"B"},
    {q:"AÅŸaÄŸÄ±daki maddelerden hangisi suda batmaz?", a:["TaÅŸ","Metal para","Plastik ÅŸiÅŸe","Ã‡elik Ã§ivi"], c:"C"},
    {q:"Suyu emen maddeler hangi amaÃ§la kullanÄ±lÄ±r?", a:["Su geÃ§irmez kÄ±yafetlerde","Kurulamada","YalÄ±tÄ±mda","SÃ¼s eÅŸyalarÄ±nda"], c:"B"},
    {q:"Suyu emmeyen maddeler hangi amaÃ§la kullanÄ±lÄ±r?", a:["Havlu yapÄ±mÄ±nda","PeÃ§ete yapÄ±mÄ±nda","YaÄŸmurluk yapÄ±mÄ±nda","SÃ¼nger yapÄ±mÄ±nda"], c:"C"},
    {q:"Gemilerin suda yÃ¼zmesini saÄŸlayan ÅŸey nedir?", a:["AÄŸÄ±r olmalarÄ±","Suyu emmeleri","Hacimlerinin bÃ¼yÃ¼k olmasÄ±","Åžekilleri"], c:"C"},
    {q:"Ã‡ivinin suda batmasÄ±nÄ±n nedeni nedir?", a:["Suyu emmesi","MÄ±knatÄ±sla Ã§ekilmesi","YoÄŸunluÄŸunun sudan fazla olmasÄ±","Hacminin kÃ¼Ã§Ã¼k olmasÄ±"], c:"C"},
    {q:"KÃ¼tle ile ilgili aÅŸaÄŸÄ±dakilerden hangisi doÄŸrudur?", a:["DeÄŸiÅŸmeyen madde miktarÄ±dÄ±r.","BoÅŸlukta kapladÄ±ÄŸÄ± yerdir.","Duyu organlarÄ±yla algÄ±lanÄ±r.","Sadece katÄ±larda vardÄ±r."], c:"A"},
    {q:"Hacim ile ilgili aÅŸaÄŸÄ±dakilerden hangisi doÄŸrudur?", a:["DeÄŸiÅŸmeyen madde miktarÄ±dÄ±r.","BoÅŸlukta kapladÄ±ÄŸÄ± yerdir.","Terazi ile Ã¶lÃ§Ã¼lÃ¼r.","Sadece sÄ±vÄ±larda vardÄ±r."], c:"B"},
    {q:"Bir cismin kÃ¼tlesi DÃ¼nyaâ€™da ve Ayâ€™da Ã¶lÃ§Ã¼ldÃ¼ÄŸÃ¼nde nasÄ±l deÄŸiÅŸir?", a:["DÃ¼nyaâ€™da daha fazladÄ±r.","Ayâ€™da daha fazladÄ±r.","AynÄ±dÄ±r.","Ã–lÃ§Ã¼lemez."], c:"C"},
    {q:"Bir cismin aÄŸÄ±rlÄ±ÄŸÄ± DÃ¼nyaâ€™da ve Ayâ€™da Ã¶lÃ§Ã¼ldÃ¼ÄŸÃ¼nde nasÄ±l deÄŸiÅŸir?", a:["DÃ¼nyaâ€™da daha fazladÄ±r.","Ayâ€™da daha fazladÄ±r.","AynÄ±dÄ±r.","Ã–lÃ§Ã¼lemez."], c:"A"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi sÄ±vÄ±larÄ±n Ã¶zelliÄŸi deÄŸildir?", a:["AkÄ±ÅŸkandÄ±r.","Belirli bir ÅŸekli yoktur.","SÄ±kÄ±ÅŸtÄ±rÄ±lamaz.","Tanecikleri arasÄ±ndaki boÅŸluk fazladÄ±r."], c:"D"},
    {q:"GazlarÄ±n Ã¶zelliklerinden biri deÄŸildir?", a:["BulunduklarÄ± kabÄ±n ÅŸeklini alÄ±rlar.","SÄ±kÄ±ÅŸtÄ±rÄ±labilirler.","Belirli bir hacimleri yoktur.","AkÄ±ÅŸkan deÄŸillerdir."], c:"D"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi katÄ±, sÄ±vÄ± ve gaz hallerinde bulunabilir?", a:["Demir","Su","Tahta","Cam"], c:"B"},
    {q:"IsÄ± alan buz ne olur?", a:["Su","Su buharÄ±","Kar","YaÄŸmur"], c:"A"},
    {q:"IsÄ± veren su ne olur?", a:["Buz","Su buharÄ±","Kar","Ã‡iy"], c:"A"},
    {q:"SÄ±cak Ã§ayÄ±n soÄŸumasÄ± hangi olaya Ã¶rnektir?", a:["IsÄ±nma","SoÄŸuma","Erime","Donma"], c:"B"},
    {q:"SoÄŸuk sÃ¼tÃ¼n Ä±sÄ±nmasÄ± hangi olaya Ã¶rnektir?", a:["IsÄ±nma","SoÄŸuma","Erime","Donma"], c:"A"},
    {q:"Saf maddelerle karÄ±ÅŸÄ±mlar arasÄ±ndaki fark nedir?", a:["Saf maddeler tek tÃ¼r, karÄ±ÅŸÄ±mlar birden fazla tÃ¼r madde iÃ§erir.","Saf maddeler karÄ±ÅŸÄ±mlara gÃ¶re daha hafiftir.","KarÄ±ÅŸÄ±mlar saf maddelere gÃ¶re daha kÃ¼Ã§Ã¼ktÃ¼r.","Saf maddeler sadece katÄ± halde bulunur."], c:"A"},
    {q:"AÅŸaÄŸÄ±dakilerden hangisi karÄ±ÅŸÄ±m deÄŸildir?", a:["Meyve suyu","Åžeker","Salata","Ã‡orba"], c:"B"},
    {q:"KarÄ±ÅŸÄ±mlar nasÄ±l ayrÄ±ÅŸtÄ±rÄ±labilir?", a:["KarÄ±ÅŸÄ±mÄ± oluÅŸturan maddelerin Ã¶zelliklerine gÃ¶re","Sadece Ä±sÄ± vererek","Sadece suya atarak","Sadece mÄ±knatÄ±s kullanarak"], c:"A"},
    {q:"Tuzlu su karÄ±ÅŸÄ±mÄ±nÄ± ayÄ±rmak iÃ§in hangi yÃ¶ntem kullanÄ±lÄ±r?", a:["Eleme","SÃ¼zme","BuharlaÅŸtÄ±rma","MÄ±knatÄ±sla ayÄ±rma"], c:"C"},
    {q:"Kum ve Ã§akÄ±l karÄ±ÅŸÄ±mÄ±nÄ± ayÄ±rmak iÃ§in hangi yÃ¶ntem kullanÄ±lÄ±r?", a:["Eleme","SÃ¼zme","BuharlaÅŸtÄ±rma","MÄ±knatÄ±sla ayÄ±rma"], c:"A"}
  ];

  /************************************************************
   * YardÄ±mcÄ±lar + Toast
   ************************************************************/
  const $ = (id)=>document.getElementById(id);
  const toastEl = $("toast");
  function toast(msg){
    toastEl.textContent = msg;
    toastEl.classList.add("show");
    clearTimeout(toastEl._t);
    toastEl._t = setTimeout(()=>toastEl.classList.remove("show"), 2200);
  }

    /************************************************************
 * SES AYARLARI (Mobil Uyumlu & Ses AyarÄ± Ã‡alÄ±ÅŸan Versiyon)
 ************************************************************/
const music = new Audio("madde.mp3");
music.loop = true;
music.preload = "metadata";

const sOK = new Audio("alkis.mp3");
const sNO = new Audio("hata.mp3");

// BaÅŸlangÄ±Ã§ deÄŸerlerini slider'lardan alalÄ±m
let musicOn = true, fxOn = true;
let musicVol = parseFloat(document.getElementById("musicVol").value);
let fxVol = parseFloat(document.getElementById("fxVol").value);

function applyAudio() {
    // MÃ¼zik ayarÄ±
    if (music) {
        music.volume = musicOn ? musicVol : 0;
    }
    // Efekt ayarlarÄ±
    if (sOK && sNO) {
        sOK.volume = fxOn ? fxVol : 0;
        sNO.volume = fxOn ? fxVol : 0;
    }
}

// Mobilde ses kilidini aÃ§mak iÃ§in deÄŸiÅŸken
let audioUnlocked = false;

async function unlockAudio() {
    if (audioUnlocked) return;
    try {
        // AyarlarÄ± uygulamadan Ã§almaya baÅŸlama
        applyAudio();
        
        await music.play();
        if (!musicOn) music.pause();

        sOK.play(); sOK.pause();
        sNO.play(); sNO.pause();

        audioUnlocked = true;
        console.log("Ses kilidi ve ayarlar baÅŸarÄ±yla yÃ¼klendi.");
    } catch (err) {
        console.error("Ses baÅŸlatÄ±lamadÄ±:", err);
    }
}

// SES KISMA/AÃ‡MA Ã‡UBUKLARI (Slider Dinleyicileri)
document.getElementById("musicVol").addEventListener("input", (e) => {
    musicVol = parseFloat(e.target.value);
    applyAudio(); // Her hareket ettiÄŸinde sesi gÃ¼ncelle
});

document.getElementById("fxVol").addEventListener("input", (e) => {
    fxVol = parseFloat(e.target.value);
    applyAudio(); // Her hareket ettiÄŸinde sesi gÃ¼ncelle
});

// AÃ‡/KAPAT BUTONLARI
document.getElementById("musicToggle").addEventListener("click", () => {
    musicOn = !musicOn;
    document.getElementById("musicToggle").textContent = musicOn ? "AÃ§Ä±k" : "KapalÄ±";
    if (musicOn && audioUnlocked) {
        music.play().catch(() => {});
    } else {
        music.pause();
    }
    applyAudio();
});

document.getElementById("fxToggle").addEventListener("click", () => {
    fxOn = !fxOn;
    document.getElementById("fxToggle").textContent = fxOn ? "AÃ§Ä±k" : "KapalÄ±";
    applyAudio();
});

// BAÅžLAT BUTONU
document.getElementById("btnStart").addEventListener("click", () => {
    unlockAudio(); // Ses kilidini aÃ§ ve baÅŸlangÄ±Ã§ ses seviyelerini uygula
    if (typeof startGame === "function") startGame();
});

// Sayfa ilk yÃ¼klendiÄŸinde ayarlarÄ± bir kez uygula
applyAudio();


  /************************************************************
   * Confetti (mor + mavi)
   ************************************************************/
  const confettiCanvas = $("confetti");
  const ctx = confettiCanvas.getContext("2d");
  function resizeConfetti(){
    confettiCanvas.width = innerWidth * devicePixelRatio;
    confettiCanvas.height = innerHeight * devicePixelRatio;
  }
  addEventListener("resize", resizeConfetti);
  resizeConfetti();

  let confetti = [];
  function burstConfetti(){
    const W=confettiCanvas.width, H=confettiCanvas.height;
    for(let i=0;i<200;i++){
      confetti.push({
        x: W*0.5 + (Math.random()-0.5)*W*0.14,
        y: H*0.18 + (Math.random()-0.5)*H*0.08,
        vx: (Math.random()-0.5)*8*devicePixelRatio,
        vy: (Math.random()*-10 - 6)*devicePixelRatio,
        g: (0.35 + Math.random()*0.25)*devicePixelRatio,
        w: (2.0 + Math.random()*4.2)*devicePixelRatio,
        h: (1.0 + Math.random()*2.5)*devicePixelRatio,
        a: 1,
        rot: Math.random()*Math.PI,
        vr: (Math.random()-0.5)*0.25,
        t: Math.random() < 0.5 ? "P" : "B"
      });
    }
  }
  function tickConfetti(){
    const W=confettiCanvas.width, H=confettiCanvas.height;
    ctx.clearRect(0,0,W,H);
    confetti = confetti.filter(p=>p.a>0.02 && p.y < H + 80*devicePixelRatio);
    for(const p of confetti){
      p.vy += p.g;
      p.x += p.vx;
      p.y += p.vy;
      p.rot += p.vr;
      p.a *= 0.985;

      ctx.save();
      ctx.globalAlpha = p.a;
      ctx.translate(p.x,p.y);
      ctx.rotate(p.rot);
      ctx.fillStyle = (p.t==="P") ? "rgba(180,92,255,1)" : "rgba(67,183,255,1)";
      ctx.fillRect(-p.w, -p.h, p.w*2, p.h*2);
      ctx.restore();
    }
    requestAnimationFrame(tickConfetti);
  }
  tickConfetti();

  /************************************************************
   * Oyun MantÄ±ÄŸÄ±
   ************************************************************/
  const MODE_LIST = [10,20,30,40];

  const S = {
    mode: 10,
    lbMode: 10,
    player: "",
    score: 0,
    idx: 0,
    selected: [],
    startedAt: 0,
    timeSec: 0,
    timer: null,
    locked: false,
    resetVersion: 1
  };

  // Oturum boyunca tekrar etmeyen havuzlar (mode bazlÄ±)
  const SESSION_POOLS = new Map(); // mode -> { pool:[idx...], ptr:number }

  function makePool(){
    const arr = BANK.map((_,i)=>i);
    for(let i=arr.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [arr[i],arr[j]]=[arr[j],arr[i]];
    }
    return arr;
  }

  function pickQuestionsNoRepeatSession(mode){
    if(mode > BANK.length) return [];
    let entry = SESSION_POOLS.get(mode);
    if(!entry || !Array.isArray(entry.pool) || typeof entry.ptr!=="number"){
      entry = { pool: makePool(), ptr: 0 };
      SESSION_POOLS.set(mode, entry);
    }

    // Havuzda yeterli kalmadÄ±ysa yeniden karÄ±ÅŸtÄ±r
    if(entry.ptr + mode > entry.pool.length){
      entry.pool = makePool();
      entry.ptr = 0;
    }

    const slice = entry.pool.slice(entry.ptr, entry.ptr + mode);
    entry.ptr += mode;
    return slice;
  }

  const BANNED = [
    "amk","aq","siktir","sik","yarrak","orospu","piÃ§","pÄ±c","p1Ã§","ananÄ±","anan","babanÄ±","baba","mk",
    "salak","mal","gerizekalÄ±","aptal","yavÅŸak","ibne"
  ];
  function normalizeName(str){
    return (str||"").trim().replace(/\s+/g," ").replace(/[^\p{L}\p{N}\s.'-]/gu,"");
  }
  function isBadName(name){
    const n = name.toLowerCase().replace(/\s+/g,"");
    if(n.length < 2) return true;
    return BANNED.some(w => n.includes(w));
  }

  const bMode = $("bMode");
  const bScore = $("bScore");
  const bTime = $("bTime");

  const startPanel = $("startPanel");
  const quizPanel = $("quizPanel");
  const finishPanel = $("finishPanel");

  const qIndex = $("qIndex");
  const qText = $("qText");
  const opts = $("opts");
  const miniProgress = $("miniProgress");
  const feedback = $("feedback");
  const qbox = $("qbox");

  function setBadges(){
    bMode.textContent = `Mod: ${S.mode}`;
    bScore.textContent = `Skor: ${S.score}`;
    bTime.textContent = `SÃ¼re: ${S.timeSec} sn`;
  }

  function resetUIToStart(){
    clearInterval(S.timer);
    S.timer=null;
    S.locked=false;
    feedback.textContent = "";
    feedback.className = "feedback";
    qbox.classList.remove("flashGood","flashBad");

    quizPanel.style.display="none";
    finishPanel.style.display="none";
    startPanel.style.display="block";
    setBadges();
  }

  // Mod butonlarÄ±
  const modeButtons = $("modeButtons");
  function renderModeButtons(){
    modeButtons.innerHTML="";
    for(const m of MODE_LIST){
      const d=document.createElement("div");
      d.className="modeBtn"+(m===S.mode?" active":"");
      d.textContent = `${m} Soru`;
      d.addEventListener("click",()=>{
        S.mode=m;
        [...modeButtons.children].forEach(x=>x.classList.remove("active"));
        d.classList.add("active");
        setBadges();
      });
      modeButtons.appendChild(d);
    }
  }
  renderModeButtons();

  // Skor tablosu sekmeleri
  const lbTabs = $("lbTabs");
  function renderLBTabs(){
    lbTabs.innerHTML="";
    for(const m of MODE_LIST){
      const t=document.createElement("div");
      t.className="tab"+(m===S.lbMode?" active":"");
      t.textContent = `${m} Soru`;
      t.addEventListener("click",()=>{
        S.lbMode=m;
        renderLBTabs();
        renderLeaderboard();
      });
      lbTabs.appendChild(t);
    }
  }
  renderLBTabs();

  function showQuestion(){
    qbox.classList.remove("flashGood","flashBad");
    feedback.textContent = "";
    feedback.className = "feedback";

    const cur = BANK[S.selected[S.idx]];
    qIndex.textContent = `Soru ${S.idx+1}/${S.mode}`;
    qText.textContent = cur.q;

    opts.innerHTML="";
    const letters=["A","B","C","D"];
    for(let i=0;i<4;i++){
      const el=document.createElement("div");
      el.className="opt";
      el.innerHTML = `<span class="k">${letters[i]})</span>${cur.a[i]}`;
      el.addEventListener("click",()=>choose(letters[i]));
      opts.appendChild(el);
    }
    miniProgress.textContent = `DoÄŸru: ${S.score} â€¢ Kalan: ${S.mode-(S.idx+1)}`;
    setBadges();
  }

  async function playFx(audio){
    if(!fxOn) return;
    try{
      audio.currentTime = 0;
      await audio.play();
    }catch{}
  }

  async function choose(letter){
    if(S.locked) return;
    S.locked=true;

    const cur = BANK[S.selected[S.idx]];
    const correct = cur.c;

    [...opts.children].forEach(x=>x.classList.add("disabled"));

    const letters=["A","B","C","D"];
    for(let i=0;i<4;i++){
      const el=opts.children[i];
      if(letters[i]===correct) el.classList.add("correct");
      if(letters[i]===letter && letter!==correct) el.classList.add("wrong");
    }

    const isCorrect = (letter===correct);

    if(isCorrect){
      S.score++;
      qbox.classList.add("flashGood");
      feedback.textContent = "DoÄŸru âœ…";
      feedback.classList.add("good");
      burstConfetti();
      await playFx(sOK);
      if(navigator.vibrate) try{ navigator.vibrate(30); }catch{}
    }else{
      qbox.classList.add("flashBad");
      feedback.textContent = "YanlÄ±ÅŸ âŒ";
      feedback.classList.add("bad");
      await playFx(sNO);
      if(navigator.vibrate) try{ navigator.vibrate([20,40,20]); }catch{}
    }

    setBadges();

    setTimeout(async ()=>{
      S.idx++;
      S.locked=false;

      if(S.idx >= S.mode){
        await finishGameAndSave();
      }else{
        showQuestion();
      }
    }, ANSWER_REVEAL_MS);
  }

  function startGame(){
    if(S.mode > BANK.length){
      toast("Soru bankasÄ± yetersiz.");
      return;
    }

    const raw = $("playerName").value;
    const name = normalizeName(raw);

    if(!name || name.length>18 || isBadName(name)){
      toast("Ä°sim uygun deÄŸil.");
      return;
    }

    // Her oyun baÅŸlangÄ±cÄ±nda arka plan deÄŸiÅŸsin
    pickBg();

    finishPanel.style.display="none";
    startPanel.style.display="none";
    quizPanel.style.display="block";

    S.player=name;
    S.score=0;
    S.idx=0;

    // âœ… Oturum boyunca tekrar etmeyen rastgele seÃ§im
    S.selected = pickQuestionsNoRepeatSession(S.mode);

    S.startedAt=Date.now();
    S.timeSec=0;
    S.locked=false;

    clearInterval(S.timer);
    S.timer = setInterval(()=>{
      S.timeSec = Math.floor((Date.now()-S.startedAt)/1000);
      bTime.textContent = `SÃ¼re: ${S.timeSec} sn`;
    }, 250);

    setBadges();
    showQuestion();
  }

  async function finishGameAndSave(){
    clearInterval(S.timer);
    S.timer=null;
    setBadges();

    $("fName").textContent = S.player;
    $("fMode").textContent = `${S.mode} Soru`;
    $("fScore").textContent = `${S.score}/${S.mode}`;
    $("fTime").textContent = fmtTime(S.timeSec);

    quizPanel.style.display="none";
    finishPanel.style.display="block";

    await saveScoreToFirebase();
    renderLeaderboard();
  }

  $("btnStart").addEventListener("click", startGame);

  $("btnRestart").addEventListener("click", ()=>{
    // aynÄ± isimle tekrar baÅŸlat
    finishPanel.style.display="none";
    startPanel.style.display="none";
    quizPanel.style.display="block";

    // Her restartâ€™ta da arka plan deÄŸiÅŸsin
    pickBg();

    S.score=0;
    S.idx=0;
    S.selected = pickQuestionsNoRepeatSession(S.mode);
    S.startedAt=Date.now();
    S.timeSec=0;
    S.locked=false;

    clearInterval(S.timer);
    S.timer = setInterval(()=>{
      S.timeSec = Math.floor((Date.now()-S.startedAt)/1000);
      bTime.textContent = `SÃ¼re: ${S.timeSec} sn`;
    }, 250);

    setBadges();
    showQuestion();
  });

  $("btnHome").addEventListener("click", ()=>{
    resetUIToStart();
  });

  /************************************************************
   * FIREBASE (Firestore)
   ************************************************************/
  let app=null, db=null, cloudReady=false;
  let fs=null;

  const SETTINGS_DOC = ["settings","global"]; // resetVersion burada

  async function initFirebase(){
    try{
      const { initializeApp } = await import("https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js");
      const {
        getFirestore, collection, addDoc, query, where, orderBy, limit, getDocs,
        serverTimestamp, doc, getDoc, setDoc, updateDoc, onSnapshot
      } = await import("https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js");

      fs = { getFirestore, collection, addDoc, query, where, orderBy, limit, getDocs, serverTimestamp, doc, getDoc, setDoc, updateDoc, onSnapshot };

      app = initializeApp(firebaseConfig);
      db = getFirestore(app);
      cloudReady = true;

      await ensureSettingsDoc();
      await syncResetVersion();
      await renderLeaderboard();

      // PC: Shift + Z reset
      addEventListener("keydown", async (e)=>{
        if(e.shiftKey && e.key.toLowerCase()==="z"){
          const ok = confirm("Skor tablosu sÄ±fÄ±rlansÄ±n mÄ±?");
          if(!ok) return;
          try{
            await cloudResetAll();
            toast("SÄ±fÄ±rlandÄ± âœ…");
          }catch(err){
            console.warn(err);
            toast("SÄ±fÄ±rlama: " + (err?.code || "hata"));
          }
        }
      });

      // Mobil: logoya 6sn basÄ±lÄ± tut
      enableMobileResetGesture();

    }catch(err){
      console.warn(err);
      $("lbBody").innerHTML = `<tr><td colspan="4" style="color:var(--muted);">Firebase baÄŸlantÄ±sÄ± yok.</td></tr>`;
      toast("Firebase: baÄŸlantÄ± yok");
    }
  }

  async function ensureSettingsDoc(){
    if(!cloudReady || !db) return;
    const { doc, getDoc, setDoc, serverTimestamp } = fs;
    const ref = doc(db, ...SETTINGS_DOC);
    try{
      const snap = await getDoc(ref);
      if(!snap.exists()){
        await setDoc(ref, { resetVersion: 1, createdAt: serverTimestamp() }, { merge:true });
      }
    }catch(err){
      console.warn(err);
      toast("settings/global: " + (err?.code || "hata"));
    }
  }

  async function syncResetVersion(){
    if(!cloudReady || !db) return;
    const { doc, getDoc, onSnapshot } = fs;
    const ref = doc(db, ...SETTINGS_DOC);

    try{
      const snap = await getDoc(ref);
      if(snap.exists()){
        const v = snap.data().resetVersion;
        if(typeof v === "number") S.resetVersion = v;
      }
    }catch{}

    try{
      onSnapshot(ref, (snap)=>{
        if(!snap.exists()) return;
        const v = snap.data().resetVersion;
        if(typeof v !== "number") return;
        if(v !== S.resetVersion){
          S.resetVersion = v;
          renderLeaderboard();
        }
      });
    }catch{}
  }

  async function cloudResetAll(){
    const { doc, setDoc, serverTimestamp } = fs;
    const ref = doc(db, ...SETTINGS_DOC);
    const next = (S.resetVersion || 1) + 1;
    // âœ… doc yoksa bile Ã§alÄ±ÅŸsÄ±n
    await setDoc(ref, { resetVersion: next, updatedAt: serverTimestamp() }, { merge:true });
  }

  async function saveScoreToFirebase(){
    if(!cloudReady || !db) { toast("KayÄ±t yok: Firebase"); return; }
    if(!navigator.onLine) { toast("Ä°nternet yok: kayÄ±t yapÄ±lmadÄ±"); return; }

    const { collection, addDoc, serverTimestamp } = fs;

    const payload = {
      name: S.player,
      score: S.score,
      timeSec: S.timeSec,
      mode: S.mode,
      resetVersion: S.resetVersion,
      createdAt: serverTimestamp()
    };

    try{
      await addDoc(collection(db, "leaderboard"), payload);
      toast("Kaydedildi âœ…");
    }catch(err){
      console.warn(err);
      toast("KayÄ±t hatasÄ±: " + (err?.code || "hata"));
    }
  }

  function fmtTime(sec){
    sec = Math.max(0, Math.floor(sec||0));
    if(sec < 60) return `${sec}s`;
    const m = Math.floor(sec/60);
    const s = sec%60;
    return `${m}dk ${s}s`;
  }

  function escapeHtml(s){
    return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
  }

  async function renderLeaderboard(){
    const body = $("lbBody");
    body.innerHTML = `<tr><td colspan="4" style="color:var(--muted);">YÃ¼kleniyor...</td></tr>`;

    if(!cloudReady || !db){
      body.innerHTML = `<tr><td colspan="4" style="color:var(--muted);">Firebase baÄŸlantÄ±sÄ± yok.</td></tr>`;
      return;
    }

    const { collection, query, where, orderBy, limit, getDocs } = fs;

    try{
      // Not: Bu sorgu iÃ§in Firestore index isteyebilir.
      // EÄŸer index isterse konsolda link Ã§Ä±kar: "Create index" ile 1 kere oluÅŸturulur.
      const q = query(
        collection(db, "leaderboard"),
        where("mode","==", S.lbMode),
        where("resetVersion","==", S.resetVersion),
        orderBy("score","desc"),
        orderBy("timeSec","asc"),
        limit(20)
      );

      const snap = await getDocs(q);
      if(snap.empty){
        body.innerHTML = `<tr><td colspan="4" style="color:var(--muted);">HenÃ¼z veri yok.</td></tr>`;
        return;
      }

      let i=0;
      body.innerHTML = "";
      snap.forEach(docu=>{
        const d = docu.data();
        i++;
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${i}</td>
          <td>${escapeHtml(d.name ?? "")}</td>
          <td class="right">${Number(d.score ?? 0)}</td>
          <td class="right">${fmtTime(Number(d.timeSec ?? 0))}</td>
        `;
        body.appendChild(tr);
      });

    }catch(err){
      console.warn(err);
      const code = err?.code || "hata";
      body.innerHTML = `<tr><td colspan="4" style="color:var(--muted);">Okuma hatasÄ±: ${escapeHtml(code)}</td></tr>`;
      toast("Skor okuma: " + code);
    }
  }

  function enableMobileResetGesture(){
    const el = $("teacherReset");
    if(!el) return;
    let t=null;

    const start = ()=>{
      t = setTimeout(async ()=>{
        const ok = confirm("Skor tablosu sÄ±fÄ±rlansÄ±n mÄ±?");
        if(!ok) return;
        try{
          await cloudResetAll();
          toast("SÄ±fÄ±rlandÄ± âœ…");
        }catch(err){
          console.warn(err);
          toast("SÄ±fÄ±rlama: " + (err?.code || "hata"));
        }
      }, 6000);
    };
    const cancel = ()=>{ if(t) clearTimeout(t); t=null; };

    el.addEventListener("touchstart", start, {passive:true});
    el.addEventListener("touchend", cancel);
    el.addEventListener("touchcancel", cancel);
  }

  // BaÅŸlat
  setBadges();
  initFirebase();
</script>
</body>
</html>
